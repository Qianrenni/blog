{"version":3,"file":"js/6200.647119db.js","mappings":"oHAAA,iiL","sources":["webpack://myblog/./src/assets/md/java/content/010-åJava åŠ¨æ€ä»£ç† Dynamic Proxyè¯¦è§£.md"],"sourcesContent":["export default \"# **åã€Java åŠ¨æ€ä»£ç† ï¼ˆDynamic Proxyï¼‰è¯¦è§£**\\r\\n\\r\\nJava åŠ¨æ€ä»£ç†æ˜¯ä¸€ç§**è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»çš„æŠ€æœ¯**ï¼Œå®ƒæ˜¯ Java åå°„æœºåˆ¶çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡åŠ¨æ€ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹ï¼Œå¯¹ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œå¢å¼ºæˆ–æ‹¦æˆªï¼Œæ˜¯ AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„åŸºç¡€ã€‚\\r\\n\\r\\n## **ğŸ“Œ 1ã€ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿ**\\r\\n\\r\\n### å®šä¹‰\\r\\n\\r\\nåŠ¨æ€ä»£ç†æ˜¯æŒ‡åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ¹æ®ä¼ å…¥çš„çœŸå®å¯¹è±¡ï¼ˆè¢«ä»£ç†å¯¹è±¡ï¼‰ï¼Œ**åŠ¨æ€åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡**ï¼Œå¹¶ç”¨è¿™ä¸ªä»£ç†å¯¹è±¡æ¥ä»£æ›¿çœŸå®å¯¹è±¡å®Œæˆæ“ä½œã€‚\\r\\n\\r\\n### æ ¸å¿ƒä½œç”¨\\r\\n\\r\\n- **åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å‰æä¸‹ï¼Œå¯¹æ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼º**\\r\\n- **å®ç°è§£è€¦ï¼Œæé«˜ä»£ç çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§**\\r\\n- **AOPï¼ˆå¦‚ Spring AOPï¼‰åº•å±‚å®ç°åŸç†**\\r\\n\\r\\n---\\r\\n\\r\\n## **ğŸ§± 2ã€æ ¸å¿ƒ API å’Œç±»**\\r\\n\\r\\n| ç±»/æ¥å£ | è¯´æ˜ |\\r\\n|--------|------|\\r\\n| `java.lang.reflect.Proxy` | æ ¸å¿ƒç±»ï¼Œç”¨äºç”Ÿæˆä»£ç†å¯¹è±¡ |\\r\\n| `java.lang.reflect.InvocationHandler` | æ¥å£ï¼Œç”¨äºå®šä¹‰ä»£ç†é€»è¾‘ |\\r\\n| `java.lang.reflect.Method` | è¡¨ç¤ºè¢«è°ƒç”¨çš„æ–¹æ³•å¯¹è±¡ |\\r\\n\\r\\n---\\r\\n\\r\\n## **ğŸ› ï¸ 3ã€åŠ¨æ€ä»£ç†çš„ä½¿ç”¨æ­¥éª¤**\\r\\n\\r\\n### âœ… æ­¥éª¤ 1ï¼šå®šä¹‰æ¥å£ï¼ˆå¿…é¡»ï¼‰\\r\\n\\r\\n```java\\r\\npublic interface UserService {\\r\\n    void addUser();\\r\\n    void deleteUser();\\r\\n}\\r\\n```\\r\\n\\r\\n> âš ï¸ æ³¨æ„ï¼šJava åŠ¨æ€ä»£ç†åªèƒ½å¯¹æ¥å£è¿›è¡Œä»£ç†ï¼\\r\\n\\r\\n---\\r\\n\\r\\n### âœ… æ­¥éª¤ 2ï¼šå®ç°æ¥å£ç±»ï¼ˆçœŸå®å¯¹è±¡ï¼‰\\r\\n\\r\\n```java\\r\\npublic class UserServiceImpl implements UserService {\\r\\n    @Override\\r\\n    public void addUser() {\\r\\n        System.out.println(\\\"æ·»åŠ ç”¨æˆ·\\\");\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public void deleteUser() {\\r\\n        System.out.println(\\\"åˆ é™¤ç”¨æˆ·\\\");\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n---\\r\\n\\r\\n### âœ… æ­¥éª¤ 3ï¼šå®ç° InvocationHandler æ¥å£ï¼ˆå®šä¹‰ä»£ç†é€»è¾‘ï¼‰\\r\\n\\r\\n```java\\r\\nimport java.lang.reflect.InvocationHandler;\\r\\nimport java.lang.reflect.Method;\\r\\n\\r\\npublic class MyInvocationHandler implements InvocationHandler {\\r\\n\\r\\n    private Object target; // è¢«ä»£ç†çš„å¯¹è±¡\\r\\n\\r\\n    public MyInvocationHandler(Object target) {\\r\\n        this.target = target;\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\\r\\n        System.out.println(\\\"ã€å‰ç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œå‰ï¼š\\\" + method.getName());\\r\\n\\r\\n        // æ‰§è¡ŒçœŸå®å¯¹è±¡çš„æ–¹æ³•\\r\\n        Object result = method.invoke(target, args);\\r\\n\\r\\n        System.out.println(\\\"ã€åç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œåï¼š\\\" + method.getName());\\r\\n        return result;\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n---\\r\\n\\r\\n### âœ… æ­¥éª¤ 4ï¼šç”Ÿæˆä»£ç†å¯¹è±¡å¹¶è°ƒç”¨\\r\\n\\r\\n```java\\r\\nimport java.lang.reflect.Proxy;\\r\\n\\r\\npublic class TestProxy {\\r\\n    public static void main(String[] args) {\\r\\n        // åˆ›å»ºçœŸå®å¯¹è±¡\\r\\n        UserService userService = new UserServiceImpl();\\r\\n\\r\\n        // åˆ›å»ºä»£ç†å¤„ç†å™¨\\r\\n        MyInvocationHandler handler = new MyInvocationHandler(userService);\\r\\n\\r\\n        // ç”Ÿæˆä»£ç†å¯¹è±¡\\r\\n        UserService proxy = (UserService) Proxy.newProxyInstance(\\r\\n                userService.getClass().getClassLoader(),   // ç±»åŠ è½½å™¨\\r\\n                userService.getClass().getInterfaces(),   // è¢«ä»£ç†å¯¹è±¡å®ç°çš„æ¥å£\\r\\n                handler                                   // ä»£ç†é€»è¾‘å¤„ç†å™¨\\r\\n        );\\r\\n\\r\\n        // è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•\\r\\n        proxy.addUser();\\r\\n        proxy.deleteUser();\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ“ˆ 4ã€è¾“å‡ºç»“æœ\\r\\n\\r\\n```\\r\\nã€å‰ç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œå‰ï¼šaddUser\\r\\næ·»åŠ ç”¨æˆ·\\r\\nã€åç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œåï¼šaddUser\\r\\n\\r\\nã€å‰ç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œå‰ï¼šdeleteUser\\r\\nåˆ é™¤ç”¨æˆ·\\r\\nã€åç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œåï¼šdeleteUser\\r\\n```\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ”„ 5ã€ä¸é™æ€ä»£ç†çš„åŒºåˆ«\\r\\n\\r\\n| ç‰¹ç‚¹ | é™æ€ä»£ç† | åŠ¨æ€ä»£ç† |\\r\\n|------|----------|-----------|\\r\\n| ä»£ç†ç±»æ˜¯å¦æ‰‹åŠ¨ç¼–å†™ | æ˜¯ | å¦ |\\r\\n| æ˜¯å¦æ”¯æŒå¤šä¸ªæ¥å£ | å¦ | æ˜¯ |\\r\\n| æ˜¯å¦çµæ´» | ä¸çµæ´» | çµæ´» |\\r\\n| å®ç°å¤æ‚åº¦ | ç®€å• | å¤æ‚ |\\r\\n| æ€§èƒ½ | ç•¥é«˜ | ç•¥ä½ï¼ˆä½†å·®è·ä¸å¤§ï¼‰ |\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ” 6ã€åº”ç”¨åœºæ™¯\\r\\n\\r\\n| åº”ç”¨åœºæ™¯ | è¯´æ˜ |\\r\\n|----------|------|\\r\\n| æ—¥å¿—è®°å½• | åœ¨æ–¹æ³•æ‰§è¡Œå‰åè®°å½•æ—¥å¿— |\\r\\n| æƒé™æ§åˆ¶ | æ§åˆ¶æŸäº›æ–¹æ³•æ˜¯å¦å¯ä»¥è¢«è°ƒç”¨ |\\r\\n| æ€§èƒ½ç›‘æ§ | ç»Ÿè®¡æ–¹æ³•æ‰§è¡Œæ—¶é—´ |\\r\\n| äº‹åŠ¡ç®¡ç† | åœ¨æ–¹æ³•æ‰§è¡Œå‰åå¼€å¯å’Œæäº¤äº‹åŠ¡ |\\r\\n| AOP ç¼–ç¨‹ | Spring æ¡†æ¶ä¸­å¤§é‡ä½¿ç”¨åŠ¨æ€ä»£ç†åšåˆ‡é¢å¤„ç† |\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ§© 7ã€Spring ä¸­çš„ AOP ä¸åŠ¨æ€ä»£ç†çš„å…³ç³»\\r\\n\\r\\nSpring AOP é»˜è®¤ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼ˆåŸºäºæ¥å£ï¼‰ï¼Œä½†å¦‚æœç›®æ ‡ç±»æ²¡æœ‰å®ç°æ¥å£ï¼Œåˆ™ä¼šä½¿ç”¨ **CGLIB**ï¼ˆç»§æ‰¿æ–¹å¼å®ç°ä»£ç†ï¼‰ã€‚\\r\\n\\r\\n> âœ… å¦‚æœä½ å¸Œæœ›å¼ºåˆ¶ä½¿ç”¨ CGLIB ä»£ç†ï¼Œå¯ä»¥åœ¨é…ç½®ä¸­è®¾ç½®ï¼š\\r\\n\\r\\n```xml\\r\\n<aop:config proxy-target-class=\\\"true\\\"/>\\r\\n```\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ“ 8ã€åŠ¨æ€ä»£ç†çš„å±€é™æ€§\\r\\n\\r\\n- **åªèƒ½ä»£ç†æ¥å£æ–¹æ³•**ï¼ˆJDK åŸç”ŸåŠ¨æ€ä»£ç†ï¼‰\\r\\n- **ä¸èƒ½ä»£ç†ç±»æ–¹æ³•**ï¼ˆé™¤éä½¿ç”¨ CGLIB æˆ– Javassist ç­‰ç¬¬ä¸‰æ–¹åº“ï¼‰\\r\\n- **æ€§èƒ½ç•¥ä½äºç›´æ¥è°ƒç”¨**ï¼ˆä½†ä¸€èˆ¬å½±å“ä¸å¤§ï¼‰\\r\\n- **è°ƒè¯•è¾ƒå›°éš¾**ï¼ˆå› ä¸ºä»£ç†ç±»æ˜¯è¿è¡Œæ—¶ç”Ÿæˆçš„ï¼‰\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ§ª 9ã€å®Œæ•´ä»£ç æ±‡æ€»\\r\\n\\r\\n### 1. æ¥å£å®šä¹‰\\r\\n\\r\\n```java\\r\\npublic interface UserService {\\r\\n    void addUser();\\r\\n    void deleteUser();\\r\\n}\\r\\n```\\r\\n\\r\\n### 2. å®ç°ç±»\\r\\n\\r\\n```java\\r\\npublic class UserServiceImpl implements UserService {\\r\\n    @Override\\r\\n    public void addUser() {\\r\\n        System.out.println(\\\"æ·»åŠ ç”¨æˆ·\\\");\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public void deleteUser() {\\r\\n        System.out.println(\\\"åˆ é™¤ç”¨æˆ·\\\");\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n### 3. ä»£ç†å¤„ç†å™¨\\r\\n\\r\\n```java\\r\\nimport java.lang.reflect.InvocationHandler;\\r\\nimport java.lang.reflect.Method;\\r\\n\\r\\npublic class MyInvocationHandler implements InvocationHandler {\\r\\n    private Object target;\\r\\n\\r\\n    public MyInvocationHandler(Object target) {\\r\\n        this.target = target;\\r\\n    }\\r\\n\\r\\n    @Override\\r\\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\\r\\n        System.out.println(\\\"ã€å‰ç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œå‰ï¼š\\\" + method.getName());\\r\\n        Object result = method.invoke(target, args);\\r\\n        System.out.println(\\\"ã€åç½®å¢å¼ºã€‘æ–¹æ³•æ‰§è¡Œåï¼š\\\" + method.getName());\\r\\n        return result;\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n### 4. æµ‹è¯•ç±»\\r\\n\\r\\n```java\\r\\nimport java.lang.reflect.Proxy;\\r\\n\\r\\npublic class TestProxy {\\r\\n    public static void main(String[] args) {\\r\\n        UserService userService = new UserServiceImpl();\\r\\n        MyInvocationHandler handler = new MyInvocationHandler(userService);\\r\\n        UserService proxy = (UserService) Proxy.newProxyInstance(\\r\\n            userService.getClass().getClassLoader(),\\r\\n            userService.getClass().getInterfaces(),\\r\\n            handler\\r\\n        );\\r\\n        proxy.addUser();\\r\\n        proxy.deleteUser();\\r\\n    }\\r\\n}\\r\\n```\\r\\n\\r\\n---\\r\\n\\r\\n## ğŸ§  10ã€æ€»ç»“\\r\\n\\r\\n| é¡¹ç›® | å†…å®¹ |\\r\\n|------|------|\\r\\n| åŠ¨æ€ä»£ç† | è¿è¡Œæ—¶ç”Ÿæˆä»£ç†ç±»ï¼Œç”¨äºå¢å¼ºæ–¹æ³• |\\r\\n| æ ¸å¿ƒç±» | `Proxy`, `InvocationHandler` |\\r\\n| å¿…é¡»æ¡ä»¶ | è¢«ä»£ç†ç±»å¿…é¡»å®ç°æ¥å£ |\\r\\n| ä½¿ç”¨åœºæ™¯ | æ—¥å¿—ã€æƒé™ã€äº‹åŠ¡ã€AOP |\\r\\n| ä¼˜ç‚¹ | è§£è€¦ã€çµæ´»ã€æ˜“äºæ‰©å±• |\\r\\n| ç¼ºç‚¹ | åªèƒ½ä»£ç†æ¥å£æ–¹æ³•ï¼Œè°ƒè¯•å›°éš¾ |\";"],"names":[],"sourceRoot":""}